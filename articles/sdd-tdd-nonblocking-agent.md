---
title: "マルチエージェント開発の3原則：SDD・TDD・ノンブロッキング"
emoji: "🤖"
type: "tech"
topics: ["ai", "multi-agent", "tdd", "sdd", "software-design"]
published: fales
---

# マルチエージェント開発の3原則：SDD・TDD・ノンブロッキング

## 導入（体験ベース）
マルチエージェントを使った開発にチャレンジしてきました。  
ただ、最初からうまくいったわけではありません。  

- エージェント同士のやり取りがすぐに破綻する  
- 「これは本当に動くのか？」と不安になり、人間がブロッキングしてしまう  
- 改善しては失敗する、を繰り返してきた  

そんな経験の中で、「どうすればエージェントがスムーズに連携できるか？」を真剣に考えるようになりました。  

---

## 課題① エージェント連携の破綻
前提条件が正しく伝わらない。  
エージェントによって解釈が異なる。  

特に曖昧な自然言語要件をそのまま渡すと、エージェントごとに違う理解をしてしまいます。  

- エージェントA：「平日 = 月曜〜金曜」  
- エージェントB：「平日 = 営業日（祝日除く）」  

このズレが積み重なると、最終的にテストや実装が食い違い、連携が破綻してしまうのです。  

---

## 課題② 人間がブロッキングしてしまう
エージェントがどこまで進んでいるのかが分からない。  
仕様の抜けで止まっているのか、意図的な変更なのか、**経緯が見えない**。  

経緯が分からないと「ちゃんと進んでるの？」と不安になり、どうしてもレビューや承認を**ブロック要素として差し込んでしまう**。  

結果、「自律的に進めるはずのAI」が、人間の承認待ちで停滞する──そんな本末転倒な事態に陥りました。  

---

## ログの重要性
そこで気づいたのが、**ログを残すこと**。  

- エージェント同士のやり取りを記録する  
- 人間は「なぜこうなったのか」を後から理解できる  
- 無用なブロックを減らせる  
- エージェント自身も「意思決定の透明性」を持つことでサボらない  

ログは安心感の源泉となり、ブロック要素を減らします。  

---

## 3つの原則

### 1. SDD（仕様駆動開発）
- **仕様を共通言語にする**ことで、エージェントが同じ前提で進める  
- `requirements.md`、`design.md`、`tasks.md` がその役割を担う  
- 例：「平日」の定義を事前に明記すれば、解釈ズレは起こらない  

### 2. TDD（テスト駆動開発）
- **実装前にテストを書く**ことで「到達すべきゴール」が明確になる  
- 受け入れテストと契約テストの2種類を活用  
- エージェントは「テストを通す」ことだけに集中できる  

### 3. ノンブロッキング（人間は進行を止めない）
- エージェントは**ログを残しながら自律的に進行**  
- 人間は途中で覗けるが承認待ちは挟まない  
- 最終レビュー前に**テストGREENを担保** → 人間は仕様・テスト・ログを確認するだけ  

---

## 具体例：デジタルアラームアプリ
- 要件：「平日7:00に鳴る」「スヌーズ5分」「ON/OFF切替」  
- **SDD** → requirements.md / design.md / tasks.md に落とし込む  
- **TDD** → acceptance.alarm.md と contract.clock.md を先に書く  
- **ノンブロッキング** → エージェント同士がやり取りをログ化、人間は最後にまとめて確認  

---

## まとめ
- マルチエージェント開発は**破綻リスクが高い**  
- だからこそ必要なのが次の3原則：  
  1. **SDD（仕様を共通言語にする）**  
  2. **TDD（到達基準を先に定める）**  
  3. **ノンブロッキング（人間は進行を止めない）**  
- この3つを守ることで、エージェントは自律的に動き、透明性と効率の両立が可能になる  

未来の開発では、人間は**要件と最終レビュー**に集中し、AIエージェントは**仕様とテストを頼りに止まらず進む**──そんなスタイルが当たり前になっていくと感じています。  
